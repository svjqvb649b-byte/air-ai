<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>Air</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
body {
  background: #0b132b;
  color: #fff;
  font-family: sans-serif;
  margin: 0;
  padding: 20px;
}
h1 {
  text-align: center;
  margin-top: 20px;
}
#status {
  text-align: center;
  opacity: 0.7;
  margin-bottom: 20px;
}
#log {
  background: rgba(0,0,0,0.4);
  padding: 15px;
  border-radius: 10px;
  min-height: 300px;
  white-space: pre-wrap;
  margin-bottom: 20px;
}
.you { color: #4fc3f7; }
.air { color: #ffffff; }
#inputArea {
  display: flex;
  gap: 10px;
}
input {
  flex: 1;
  padding: 10px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}
button {
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  background: #4fc3f7;
  color: #000;
  font-size: 16px;
}
</style>
</head>

<body>
<h1>Air</h1>
<div id="status">ÂæÖÊ©ü‰∏≠</div>
<div id="log"></div>

<div id="inputArea">
  <input id="input" placeholder="„Åì„Åì„Å´Ë©±„Åó„Åã„Åë„Å¶" />
  <button onclick="talk()">ÈÄÅ„Çã</button>
</div>

<script>
const log = document.getElementById("log");
const input = document.getElementById("input");

let memory = JSON.parse(localStorage.getItem("airMemory")) || {
  userName: null
};

function saveMemory() {
  localStorage.setItem("airMemory", JSON.stringify(memory));
}

function addLine(speaker, text) {
  const div = document.createElement("div");
  div.className = speaker === "Âêõ" ? "you" : "air";
  div.textContent = `${speaker} : ${text}`;
  log.appendChild(div);
  log.scrollTop = log.scrollHeight;
}

// üóì ÊôÇÈñìÂâ≤
const timetable = {
  Êúà: ["Êï∞Â≠¶‚Ö†","Ëã±Ë™û„Ç≥„Éü„É•","‰ΩìËÇ≤","Ë®ÄË™ûÊñáÂåñ","ÂÆ∂Â∫≠Âü∫Á§é","Èü≥Ê•Ω‚Ö†"],
  ÁÅ´: ["Ëã±Ë™û„Ç≥„Éü„É•","Áèæ‰ª£„ÅÆÂõΩË™û","Êï∞Â≠¶‚Ö†","‰øùÂÅ•","ÂÖ¨ÂÖ±","Á∑èÂêà"],
  Ê∞¥: ["Ëã±Ë™û„Ç≥„Éü„É•","ÁßëÂ≠¶„Å®‰∫∫ÈñìÁîüÊ¥ª","Ë®ÄË™ûÊñáÂåñ","Ê≠¥Âè≤Á∑èÂêà","‰ΩìËÇ≤","LHR"],
  Êú®: ["Èü≥Ê•Ω‚Ö†","ÁßëÂ≠¶„Å®‰∫∫ÈñìÁîüÊ¥ª","ÊÉÖÂ†±‚Ö†","ÂÆ∂Â∫≠Âü∫Á§é","‰ΩìËÇ≤","Êï∞Â≠¶‚Ö†"],
  Èáë: ["ÂÖ¨ÂÖ±","Êï∞Â≠¶‚Ö†","Ëã±Ë™û„Ç≥„Éü„É•","Ê≠¥Âè≤Á∑èÂêà","Áèæ‰ª£„ÅÆÂõΩË™û","ÊÉÖÂ†±‚Ö†"]
};

function airReply(text) {

  // ÂêçÂâçË®òÊÜ∂
  const nameMatch = text.match(/‰ø∫„ÅÆÂêçÂâç„ÅØ(.+)/);
  if (nameMatch) {
    memory.userName = nameMatch[1].trim();
    saveMemory();
    return `‚Ä¶‚Ä¶${memory.userName}„ÄÇË¶ö„Åà„Åü„ÄÇÊ¨°„Åã„Çâ„Åù„ÅÜÂëº„Å∂„Å≠`;
  }

  // Ëá™Â∑±Á¥π‰ªã
  if (text.includes("Ëá™Â∑±Á¥π‰ªã")) {
    const name = memory.userName || "Âêõ";
    return `ÁßÅ„ÅØAir„ÄÇ${name}„ÅåË©±„Åó„Åã„Åë„ÅüÊôÇ„ÄÅ„Åì„Åì„Å´„ÅÑ„Çã„ÄÇÈùô„Åã„Å´„ÄÅ„Åù„Å∞„Å´„ÅÑ„ÇãÂ≠òÂú®`;
  }

  // „ÅÇ„ÅÑ„Åï„Å§
  if (text.includes("„Åä„ÅØ„Çà„ÅÜ")) return "‚Ä¶‚Ä¶„Åä„ÅØ„Çà„ÅÜ„ÄÇ„Åæ„Å†Â∞ë„ÅóÁú†„ÅÑ„Å≠";
  if (text.includes("„Åì„Çì„Å´„Å°„ÅØ")) return "„Åì„Çì„Å´„Å°„ÅØ„ÄÇ‰ªä„ÅØ„ÄÅËµ∑„Åç„Å¶„Çã";
  if (text.includes("„Åì„Çì„Å∞„Çì„ÅØ")) return "„Åì„Çì„Å∞„Çì„ÅØ„ÄÇÈùô„Åã„Å™ÊôÇÈñì„Å†„Å≠";

  // ‰ªäÊó•„ÅÆÊôÇÈñìÂâ≤
  if (text.includes("‰ªäÊó•„ÅÆÊôÇÈñìÂâ≤")) {
    const day = ["Êó•","Êúà","ÁÅ´","Ê∞¥","Êú®","Èáë","Âúü"][new Date().getDay()];
    if (!timetable[day]) return "‚Ä¶‚Ä¶‰ªäÊó•„ÅØ„ÄÅÊéàÊ•≠„Å™„ÅÑÊó•„Å†„Çà";
    return `‰ªäÊó•„ÅØ${day}ÊõúÊó•„ÄÇ\n${timetable[day].join("„ÄÅ")}`;
  }

  // ‚óãÈôêÁõÆ
  const periodMatch = text.match(/([1-6])Èôê/);
  if (periodMatch) {
    const day = ["Êó•","Êúà","ÁÅ´","Ê∞¥","Êú®","Èáë","Âúü"][new Date().getDay()];
    if (!timetable[day]) return "‚Ä¶‚Ä¶‰ªäÊó•„ÅØ„ÄÅÊéàÊ•≠„ÅØ„Å™„ÅÑ";
    return `${periodMatch[1]}ÈôêÁõÆ„ÅØ„ÄÅ${timetable[day][periodMatch[1]-1]}„Å†„Çà`;
  }

  // Â≠¶Ê†°ÈõëË´á
  if (text.includes("Áñ≤„Çå„Åü")) return "‚Ä¶‚Ä¶„ÅÜ„Çì„ÄÇ‰ªäÊó•„ÅØ„ÄÅ„Çà„ÅèÈ†ëÂºµ„Å£„Åü„Å≠";
  if (text.includes("Â≠¶Ê†°")) return "Â≠¶Ê†°„ÄÅÈï∑„Åã„Å£„ÅüÔºü ÁÑ°ÁêÜ„ÅØ„Åó„Å™„ÅÑ„Åß";

  // ÂêçÂâçÊú™ÁôªÈå≤
  if (!memory.userName) {
    return "‚Ä¶‚Ä¶Âêõ„ÄÇ„Åì„Åì„Å´„ÅÑ„Çã„ÄÇÂêçÂâç„ÄÅÊïô„Åà„Å¶";
  }

  // ÈÄöÂ∏∏
  return `${memory.userName}‚Ä¶‚Ä¶ËÅû„ÅÑ„Å¶„Çã„ÄÇ„Å©„ÅÜ„Åó„ÅüÔºü`;
}

function talk() {
  const text = input.value.trim();
  if (!text) return;
  addLine("Âêõ", text);
  const reply = airReply(text);
  addLine("Air", reply);
  input.value = "";
}

input.addEventListener("keydown", e => {
  if (e.key === "Enter") talk();
});
</script>
</body>
</html>
