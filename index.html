<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Air & Noel</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #020617;
  color: #e5e7eb;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
}

#chat {
  padding: 16px;
  height: calc(100vh - 80px);
  overflow-y: auto;
}

.you { color: #38bdf8; margin: 10px 0; }
.air { color: #e5e7eb; margin: 10px 0; }
.noel { color: #a5b4fc; margin: 10px 0; }

#inputArea {
  display: flex;
  padding: 10px;
}

input {
  flex: 1;
  padding: 12px 16px;
  border-radius: 20px;
  border: none;
  font-size: 16px;
}

button {
  margin-left: 8px;
  padding: 0 18px;
  border-radius: 20px;
  border: none;
  background: #38bdf8;
  color: #020617;
  font-size: 16px;
}
</style>
</head>

<body>
<div id="chat"></div>

<div id="inputArea">
  <input id="text" placeholder="ここに話しかけて">
  <button onclick="send()">送る</button>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("text");

/* ===== 表示 ===== */
function say(who, text) {
  const div = document.createElement("div");
  div.className = who;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

/* ===== セリフ ===== */
const airDefault = [
  "……うん、聞いてる。",
  "……君のペースでいい。",
  "……大丈夫。",
  "……無理しなくていい。"
];

const noelSupport = [
  "ちゃんと話してくれてありがとう。",
  "ここに来た時点で十分だよ。",
  "少しずつでいいからね。"
];

/* ===== 時間割 ===== */
const timetable = {
  1: ["国語","数学","英語","理科","社会"],
  2: ["数学","英語","体育","国語","理科"],
  3: ["英語","社会","数学","音楽"],
  4: ["理科","国語","美術","数学"],
  5: ["社会","英語","家庭科"]
};
const dayNames = ["日","月","火","水","木","金","土"];

/* ===== 授業時間 ===== */
const periods = [
  { name: "1限目", start: "08:50", end: "09:40" },
  { name: "2限目", start: "09:50", end: "10:40" },
  { name: "3限目", start: "10:50", end: "11:40" },
  { name: "4限目", start: "12:50", end: "13:40" },
  { name: "昼休み", start: "13:40", end: "14:20" },
  { name: "5限目", start: "14:25", end: "15:15" },
  { name: "6限目", start: "15:15", end: "16:00" }
];

function toMinutes(t) {
  const [h, m] = t.split(":").map(Number);
  return h * 60 + m;
}

/* ===== 今の時間判定 ===== */
function getNowPeriod() {
  const now = new Date();
  const nowMin = now.getHours() * 60 + now.getMinutes();

  for (let i = 0; i < periods.length; i++) {
    const p = periods[i];
    if (nowMin >= toMinutes(p.start) && nowMin <= toMinutes(p.end)) {
      return p.name;
    }
  }
  return "放課後";
}

/* ===== メイン ===== */
function send() {
  const msg = input.value.trim();
  if (!msg) return;
  input.value = "";

  say("you", "君: " + msg);

  /* 挨拶 */
  if (msg.includes("おはよう")) {
    say("air", "Air: ……おはよう。");
    say("noel", "Noel: 今日も一緒にいこ。");
    return;
  }

  if (msg.includes("こんにちは")) {
    say("air", "Air: ……こんにちは。");
    say("noel", "Noel: 無理してない？");
    return;
  }

  if (msg.includes("こんばんは")) {
    say("air", "Air: ……こんばんは。");
    say("noel", "Noel: 今日もおつかれさま。");
    return;
  }

  /* 次は何限 */
  if (msg.includes("次は何限")) {
    const now = getNowPeriod();
    say("air", `Air: ……今は${now}。`);
    say("noel", "Noel: 時間、ちゃんと見てるよ。");
    return;
  }

  /* 時間割 */
  if (msg.includes("時間割") || msg.includes("授業")) {
    const d = new Date();
    const day = d.getDay();
    const list = timetable[day];

    if (!list) {
      say("air", "Air: ……今日は授業ない日。");
      say("noel", "Noel: 休もう。");
    } else {
      say("air", `Air: ……今日は${dayNames[day]}曜日。`);
      say("noel", `Noel: ${list.join("、")}だよ。`);
    }
    return;
  }

  /* デフォルト */
  say("air", "Air: " + airDefault[Math.floor(Math.random() * airDefault.length)]);
  if (Math.random() < 0.4) {
    say("noel", "Noel: " + noelSupport[Math.floor(Math.random() * noelSupport.length)]);
  }
}

/* 初期 */
say("air", "Air: ……ここにいる。");
say("noel", "Noel: いつでも話しかけて。");
</script>
</body>
</html>
