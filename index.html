<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Air</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  background: #0b1220;
  color: white;
  font-family: system-ui;
}
.container {
  padding: 20px;
}
.title {
  text-align: center;
  font-size: 36px;
  margin-top: 30px;
}
.status {
  text-align: center;
  opacity: 0.7;
  margin-bottom: 20px;
}
.chat {
  background: rgba(0,0,0,0.35);
  border-radius: 16px;
  padding: 16px;
  min-height: 300px;
}
.you {
  color: #4fc3f7;
  margin-bottom: 6px;
}
.air {
  margin-bottom: 14px;
}
.input-area {
  display: flex;
  gap: 10px;
  margin-top: 15px;
}
input {
  flex: 1;
  padding: 12px;
  border-radius: 20px;
  border: none;
}
button {
  padding: 12px 18px;
  border-radius: 20px;
  border: none;
  background: #4fc3f7;
  font-weight: bold;
}
</style>
</head>

<body>
<div class="container">
  <div class="title">Air</div>
  <div class="status">待機中</div>

  <div class="chat" id="chat"></div>

  <div class="input-area">
    <input id="input" placeholder="ここに話しかけて">
    <button onclick="send()">送る</button>
  </div>
</div>

<script>
const periods = [
  { name: "1限", start: "08:50", end: "09:40" },
  { name: "2限", start: "09:50", end: "10:40" },
  { name: "3限", start: "10:50", end: "11:40" },
  { name: "4限", start: "11:50", end: "12:40" },
  { name: "昼休み", start: "12:40", end: "13:25" },
  { name: "5限", start: "13:25", end: "14:15" },
  { name: "6限", start: "14:25", end: "15:15" },
  { name: "部活", start: "16:00", end: "18:00" }
];

const timetable = {
  1: ["数学", "英語コミュ", "体育", "言語文化", "家庭科", "なし"],
  2: ["英語コミュ", "現代の国語", "数学", "保健", "公共", "なし"],
  3: ["英語コミュ", "科学と人間生活", "言語文化", "歴史総合", "数学", "なし"],
  4: ["音楽", "科学と人間生活", "情報Ⅰ", "家庭基礎", "数学", "なし"],
  5: ["公共", "数学Ⅰ", "英語コミュ", "歴史総合", "現代の国語", "なし"]
};

const days = ["日","月","火","水","木","金","土"];

function reply(text) {
  const chat = document.getElementById("chat");
  chat.innerHTML += `<div class="air">Air : ${text}</div>`;
  chat.scrollTop = chat.scrollHeight;
}

function send() {
  const input = document.getElementById("input");
  const text = input.value.trim();
  if (!text) return;

  const chat = document.getElementById("chat");
  chat.innerHTML += `<div class="you">君 : ${text}</div>`;
  input.value = "";

  handle(text);
}

function handle(text) {
  const now = new Date();
  const today = now.getDay();

  /* ===== 感謝 ===== */
  if (/ありがとう/.test(text)) {
    reply("……どういたしまして。");
    return;
  }

  /* ===== 自己紹介 ===== */
  if (/自己紹介/.test(text)) {
    reply("私はAir。君の学校生活を、静かに支える存在。");
    return;
  }

  /* ===== 次の授業 ===== */
  if (/次/.test(text)) {
    const nowMin = now.getHours()*60 + now.getMinutes();
    const next = periods.find(p => {
      const [h,m] = p.start.split(":").map(Number);
      return nowMin < h*60 + m;
    });
    reply(next ? `次は${next.name}。` : "今日はもう終わり。おつかれさま。");
    return;
  }

  /* ===== 今日の時間割 ===== */
  if (/今日.*時間割/.test(text)) {
    showTimetable(today);
    return;
  }

  /* ===== 明日の時間割 ===== */
  if (/明日.*時間割/.test(text)) {
    showTimetable((today + 1) % 7);
    return;
  }

  /* ===== 曜日指定 ===== */
  for (let i=0;i<days.length;i++) {
    if (text.includes(days[i]+"曜日")) {
      showTimetable(i);
      return;
    }
  }

  /* ===== 雑談 ===== */
  if (/疲/.test(text)) {
    reply("……少し、休んだほうがいい。無理はよくない。");
    return;
  }

  reply("……うん。聞いてる。");
}

function showTimetable(day) {
  if (!timetable[day]) {
    reply(`${days[day]}曜日は休み。`);
    return;
  }
  let msg = `${days[day]}曜日の時間割は、`;
  timetable[day].forEach((c,i)=>{
    msg += `${i+1}限は${c}。`;
  });
  msg += "放課後は部活。";
  reply(msg);
}

/* 朝の一言 */
reply("……おはよう。今日は無理しないで。");
</script>
</body>
</html>
