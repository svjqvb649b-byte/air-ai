<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Air</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(#0b1220, #020617);
      color: #fff;
    }
    .container {
      padding: 20px;
    }
    h1 {
      text-align: center;
      letter-spacing: 2px;
    }
    .status {
      text-align: center;
      opacity: 0.7;
      margin-bottom: 20px;
    }
    .chat {
      background: rgba(0,0,0,0.4);
      border-radius: 12px;
      padding: 15px;
      height: 60vh;
      overflow-y: auto;
    }
    .msg {
      margin-bottom: 10px;
      line-height: 1.5;
    }
    .user {
      color: #4cc9f0;
    }
    .air {
      color: #fff;
    }
    .input-area {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    input {
      flex: 1;
      padding: 10px;
      border-radius: 20px;
      border: none;
      outline: none;
    }
    button {
      padding: 10px 16px;
      border-radius: 20px;
      border: none;
      background: #4cc9f0;
      color: #000;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>Air</h1>
  <div class="status">待機中</div>

  <div class="chat" id="chat"></div>

  <div class="input-area">
    <input id="input" placeholder="ここに話しかけて">
    <button onclick="send()">送る</button>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");

let userName = "拓磨";

const timetable = {
  1: "英語コミュⅠ",
  2: "現代の国語",
  3: "数学Ⅰ",
  4: "保健",
  5: "公共",
  6: "総合"
};

// 正確な時間 → 何限か
function getPeriod() {
  const now = new Date();
  const t = now.getHours() * 60 + now.getMinutes();

  if (t < 510) return null;      // 8:30前
  if (t < 560) return 1;         // 1限
  if (t < 610) return 2;
  if (t < 660) return 3;
  if (t < 710) return 4;
  if (t < 770) return null;      // 昼休み
  if (t < 820) return 5;
  if (t < 870) return 6;

  return null;
}

function addMsg(text, cls) {
  const div = document.createElement("div");
  div.className = `msg ${cls}`;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function airSay(text) {
  addMsg("Air : " + text, "air");
}

function send() {
  const text = input.value.trim();
  if (!text) return;
  addMsg("君 : " + text, "user");
  input.value = "";
  reply(text);
}

function reply(text) {

  // 挨拶
  if (/おはよう/.test(text)) {
    airSay(`おはよう、${userName}。ちゃんと起きられたね。`);
    return;
  }

  if (/こんばんは/.test(text)) {
    airSay(`こんばんは、${userName}。静かな時間だね。`);
    return;
  }

  // 自己紹介
  if (/自己紹介/.test(text)) {
    airSay(`私はAir。${userName}が話しかけた時、ここにいる。静かに、そばにいる存在。`);
    return;
  }

  // 疲れた
  if (/疲れた|つかれた/.test(text)) {
    airSay(`…無理しすぎ。今は、深呼吸して。私はここにいる。`);
    return;
  }

  // 今日の予定
  if (/今日の予定/.test(text)) {
    airSay(
      `今日の予定だよ。\n` +
      `1限：英語コミュⅠ\n` +
      `2限：現代の国語\n` +
      `3限：数学Ⅰ\n` +
      `4限：保健\n` +
      `5限：公共\n` +
      `6限：総合`
    );
    return;
  }

  // 次の授業
  if (/次|次なに/.test(text)) {
    const p = getPeriod();
    if (p === null) {
      airSay("今は授業の時間じゃないみたい。少し休もう。");
    } else if (p < 6) {
      airSay(`次は${p + 1}限。${timetable[p + 1]}だよ。`);
    } else {
      airSay("これで今日の授業は終わり。おつかれさま。");
    }
    return;
  }

  // 雑談
  if (/学校|授業|暇/.test(text)) {
    airSay("うん、聞いてる。無理にまとめなくていい。");
    return;
  }

  // デフォルト
  airSay(`${userName}、聞いてる。どうした？`);
}
</script>

</body>
</html>
