<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Air</title>
<style>
  body {
    background: #0b1220;
    color: white;
    font-family: sans-serif;
  }
</style>
</head>
<body>

<script>
/* ===== 時間割データ ===== */
const timetable = {
  monday: ["英語コミュⅠ", "数学", "理科", "社会", "国語", "なし"],
  tuesday: ["数学", "英語", "理科", "体育", "国語", "なし"],
  wednesday: ["英語コミュⅠ", "数学", "理科", "社会", "国語", "なし"],
  thursday: ["数学", "英語", "理科", "体育", "国語", "なし"],
  friday: ["英語", "数学", "理科", "社会", "国語", "なし"]
};

const periods = [
  "1限（8:50〜9:40）",
  "2限（9:50〜10:40）",
  "3限（10:50〜11:40）",
  "4限（11:50〜12:40）",
  "5限（13:25〜14:15）",
  "6限（14:25〜15:15）"
];

const clubTime = "部活は16:00〜18:00。";

/* ===== 雑談レパートリー ===== */
const smallTalk = [
  "……そう。",
  "無理に話さなくていい。",
  "君のペースでいい。",
  "今日は静かな日だね。",
  "……ここにいる。",
  "聞くだけなら、できる。",
  "それで、どう思った？",
  "少し疲れてる？",
  "悪くないと思う。",
  "……続けて。"
];

/* ===== ユーティリティ ===== */
function getTodayKey(offset = 0) {
  const days = ["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];
  const d = new Date();
  d.setDate(d.getDate() + offset);
  return days[d.getDay()];
}

function reply(text) {
  console.log("Air:", text);
}

/* ===== メイン応答 ===== */
function airRespond(input) {
  const msg = input.trim();

  /* 感謝 */
  if (/ありがとう/.test(msg)) {
    reply("……どういたしまして。");
    return;
  }

  /* 疲れた */
  if (/疲れ/.test(msg)) {
    reply("……無理しなくていい。");
    return;
  }

  /* 自己紹介 */
  if (/自己紹介/.test(msg)) {
    reply("私はAir。君の学校生活を、静かに支える存在。");
    return;
  }

  /* 次の授業 */
  if (/次なに/.test(msg)) {
    const now = new Date();
    const hour = now.getHours();
    let period = 0;
    if (hour < 9) period = 0;
    else if (hour < 10) period = 1;
    else if (hour < 11) period = 2;
    else if (hour < 12) period = 3;
    else if (hour < 14) period = 4;
    else period = 5;

    const today = getTodayKey();
    const subject = timetable[today]?.[period] ?? "なし";
    reply(`次は${period+1}限。${subject}。`);
    return;
  }

  /* 今日の時間割 */
  if (/今日.*時間割/.test(msg)) {
    const today = getTodayKey();
    if (!timetable[today]) {
      reply("今日は授業はない。");
      return;
    }
    let text = "今日は——\n";
    timetable[today].forEach((sub,i)=>{
      text += `${periods[i]}：${sub}\n`;
    });
    reply(text + clubTime);
    return;
  }

  /* 明日の予定 */
  if (/明日/.test(msg)) {
    const tomorrow = getTodayKey(1);
    if (!timetable[tomorrow]) {
      reply("明日は休み。");
      return;
    }
    reply("明日も、いつも通りの授業。");
    return;
  }

  /* 曜日指定 */
  if (/月曜|火曜|水曜|木曜|金曜/.test(msg)) {
    const map = {
      "月曜":"monday",
      "火曜":"tuesday",
      "水曜":"wednesday",
      "木曜":"thursday",
      "金曜":"friday"
    };
    const key = Object.keys(map).find(d=>msg.includes(d));
    const day = map[key];
    let text = `${key}は——\n`;
    timetable[day].forEach((sub,i)=>{
      text += `${periods[i]}：${sub}\n`;
    });
    reply(text + clubTime);
    return;
  }

  /* 雑談 */
  const r = smallTalk[Math.floor(Math.random() * smallTalk.length)];
  reply(r);

  /* Airからの一言 */
  setTimeout(()=>{
    reply("今日は、どんな一日だった？");
  }, 500);
}

/* ===== テスト ===== */
airRespond("今日の時間割");
airRespond("ありがとう");
airRespond("疲れた");
airRespond("水曜の予定");
airRespond("……");
</script>

</body>
</html>
